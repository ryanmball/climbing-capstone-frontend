<template>
  <div class="collections-index">
    <!-- BEGIN Title -->
    <br /><br /><br /><br /><br />
    <div class="section py-5">
      <div
        class="section-bg"
        style="background-image: url(/assets/img/corporate/mtn3.jpeg)"
      ></div>
      <div class="section-bg bg-gray-800 opacity-3"></div>
      <div class="container position-relative text-white text-center">
        <div class="display-6 fw-bolder">Collections</div>
      </div>
    </div>
    <!-- END Title -->

    <!-- BEGIN section -->
    <div class="section pt-5">
      <!-- BEGIN container -->
      <div class="container">
        <!-- BEGIN row -->
        <div class="row">
          <!-- BEGIN col-3 -->
          <div class="col-lg-3 d-none d-lg-block">
            <!-- BEGIN recent-news -->
            <div
              class="fw-bolder fs-16px mb-2"
              data-bs-toggle="collapse"
              data-bs-target="#recent-collapse"
            >
              Recent News
            </div>
            <div class="collapse show" id="recent-collapse">
              <ul class="list-unstyled fw-bold pb-3">
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >All Stories</a
                  >
                </li>
              </ul>
            </div>
            <!-- END recent-news -->

            <!-- BEGIN categories -->
            <div
              class="fw-bolder fs-16px mb-2"
              data-bs-toggle="collapse"
              data-bs-target="#categories-collapse"
            >
              Categories
            </div>
            <div class="collapse show" id="categories-collapse">
              <ul class="list-unstyled fw-bold pb-3">
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >Bootstrap</a
                  >
                </li>
              </ul>
            </div>
            <!-- END categories -->

            <!-- BEGIN topics -->
            <div
              class="fw-bolder fs-16px mb-2"
              data-bs-toggle="collapse"
              data-bs-target="#topics-collapse"
            >
              Topics
            </div>
            <div class="collapse show" id="topics-collapse">
              <ul class="list-unstyled fw-bold pb-3">
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >Color Admin</a
                  >
                </li>
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >Frontend Framework</a
                  >
                </li>
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >Technology</a
                  >
                </li>
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >Data & Privacy</a
                  >
                </li>
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >Bug Fixes</a
                  >
                </li>
                <li class="mb-2">
                  <a href="#" class="text-decoration-none text-gray-600"
                    >New Release</a
                  >
                </li>
              </ul>
            </div>
            <!-- END topics -->
          </div>
          <!-- END col-3 -->
          <!-- BEGIN col-9 -->
          <div class="col-lg-9">
            <!-- BEGIN news -->
            <div class="news">
              <!-- BEGIN row -->
              <div class="row align-items-center">
                <!-- BEGIN col-5 -->
                <div class="col-sm-5 mb-3 mb-sm-0">
                  <div class="news-media mb-0">
                    <div
                      class="news-media-img news-media-img-lg"
                      style="
                        background-image: url(../assets/img/corporate/img-3.jpg);
                      "
                    ></div>
                  </div>
                </div>
                <!-- END col-5 -->
                <!-- BEGIN col-7 -->
                <div class="col-sm-7">
                  <div class="news-content">
                    <div class="news-label">
                      <span class="bg-indigo-200 text-indigo-800"
                        >Bootstrap</span
                      >
                    </div>
                    <div class="news-title mb-2">Bootstrap 5 Beta 2</div>
                    <div class="mb-4 fw-bold text-gray-600">
                      Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                      Ut sit amet massa est. Vestibulum interdum orci non elit
                      ultricies scelerisque. Ut in neque nibh. Nam non gravida
                      diam.
                    </div>
                    <div class="news-date text-gray-400">May 27, 2021</div>
                  </div>
                  <a href="news_detail.html" class="stretched-link"></a>
                </div>
                <!-- END col-7 -->
              </div>
              <!-- END row -->
            </div>
            <!-- END news -->
            <!-- BEGIN news -->
            <div class="news">
              <!-- BEGIN row -->
              <div class="row align-items-center">
                <!-- BEGIN col-5 -->
                <div class="col-sm-5 mb-3 mb-sm-0">
                  <div class="news-media mb-0">
                    <div
                      class="news-media-img news-media-img-lg"
                      style="
                        background-image: url(../assets/img/corporate/img-15.jpg);
                      "
                    ></div>
                  </div>
                </div>
                <!-- END col-5 -->
                <!-- BEGIN col-7 -->
                <div class="col-sm-7">
                  <div class="news-content">
                    <div class="news-label">
                      <span class="bg-aqua-200 text-aqua-800">Twitter</span>
                    </div>
                    <div class="news-title mb-2">
                      Advancing our efforts to make Twitter a safer place for
                      advertisers
                    </div>
                    <div class="mb-4 fw-bold text-gray-600">
                      Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                      Ut sit amet massa est. Vestibulum interdum orci non elit
                      ultricies scelerisque. Ut in neque nibh. Nam non gravida
                      diam.
                    </div>
                    <div class="news-date text-gray-400">May 27, 2021</div>
                  </div>
                  <a href="news_detail.html" class="stretched-link"></a>
                </div>
                <!-- END col-7 -->
              </div>
              <!-- END row -->
            </div>
            <!-- END news -->
            <!-- BEGIN news -->
            <div class="news">
              <!-- BEGIN row -->
              <div class="row align-items-center">
                <!-- BEGIN col-5 -->
                <div class="col-sm-5 mb-3 mb-sm-0">
                  <div class="news-media mb-0">
                    <div
                      class="news-media-img news-media-img-lg"
                      style="
                        background-image: url(../assets/img/corporate/img-16.jpg);
                      "
                    ></div>
                  </div>
                </div>
                <div class="col-sm-7">
                  <div class="news-content">
                    <div class="news-label">
                      <span class="bg-primary-200 text-primary-800"
                        >Facebook</span
                      >
                    </div>
                    <div class="news-title mb-2">
                      Introducing the New Facebook Pages Experience
                    </div>
                    <div class="mb-4 fw-bold text-gray-600">
                      Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                      Ut sit amet massa est. Vestibulum interdum orci non elit
                      ultricies scelerisque. Ut in neque nibh. Nam non gravida
                      diam.
                    </div>
                    <div class="news-date text-gray-400">May 27, 2021</div>
                  </div>
                  <a href="news_detail.html" class="stretched-link"></a>
                </div>
                <!-- END col-7 -->
              </div>
              <!-- END row -->
            </div>
            <!-- END news -->
            <!-- BEGIN news -->
            <div class="news">
              <!-- BEGIN row -->
              <div class="row align-items-center">
                <!-- BEGIN col-5 -->
                <div class="col-sm-5 mb-3 mb-sm-0">
                  <div class="news-media mb-0">
                    <div
                      class="news-media-img news-media-img-lg"
                      style="
                        background-image: url(../assets/img/corporate/img-17.jpg);
                      "
                    ></div>
                  </div>
                </div>
                <!-- END col-5 -->
                <!-- BEGIN col-7 -->
                <div class="col-sm-7">
                  <div class="news-content">
                    <div class="news-label">
                      <span class="bg-red-200 text-red-800">Google</span>
                    </div>
                    <div class="news-title mb-2">
                      Irish retailers can build an online presence with Pointy
                    </div>
                    <div class="mb-4 fw-bold text-gray-600">
                      Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                      Ut sit amet massa est. Vestibulum interdum orci non elit
                      ultricies scelerisque. Ut in neque nibh. Nam non gravida
                      diam.
                    </div>
                    <div class="news-date text-gray-400">May 27, 2021</div>
                  </div>
                  <a href="news_detail.html" class="stretched-link"></a>
                </div>
                <!-- END col-7 -->
              </div>
              <!-- END row -->
            </div>
            <!-- END news -->
            <!-- BEGIN news -->
            <div class="news">
              <!-- BEGIN row -->
              <div class="row align-items-center">
                <!-- BEGIN col-5 -->
                <div class="col-sm-5 mb-3 mb-sm-0">
                  <div class="news-media mb-0">
                    <div
                      class="news-media-img news-media-img-lg"
                      style="
                        background-image: url(../assets/img/corporate/img-18.jpg);
                      "
                    ></div>
                  </div>
                </div>
                <!-- END col-5 -->
                <!-- BEGIN col-7 -->
                <div class="col-sm-7">
                  <div class="news-content">
                    <div class="news-label">
                      <span class="bg-green-200 text-green-800">Node JS</span>
                    </div>
                    <div class="news-title mb-2">Node v15.11.0 (Current)</div>
                    <div class="mb-4 fw-bold text-gray-600">
                      Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                      Ut sit amet massa est. Vestibulum interdum orci non elit
                      ultricies scelerisque. Ut in neque nibh. Nam non gravida
                      diam.
                    </div>
                    <div class="news-date text-gray-400">May 27, 2021</div>
                  </div>
                  <a href="news_detail.html" class="stretched-link"></a>
                </div>
                <!-- END col-7 -->
              </div>
              <!-- END row -->
            </div>
            <!-- END news -->

            <hr class="opacity-1" />
            <nav>
              <ul class="pagination d-flex">
                <li class="page-item disabled me-auto">
                  <a class="page-link fw-bold" href="#">Previous</a>
                </li>
                <li class="page-item active">
                  <a class="page-link fw-bold" href="#">1</a>
                </li>
                <li class="page-item">
                  <a class="page-link fw-bold" href="#">2</a>
                </li>
                <li class="page-item">
                  <a class="page-link fw-bold" href="#">3</a>
                </li>
                <li class="page-item">
                  <a class="page-link fw-bold" href="#">4</a>
                </li>
                <li class="page-item">
                  <a class="page-link fw-bold" href="#">5</a>
                </li>
                <li class="page-item ms-auto">
                  <a class="page-link fw-bold" href="#">Next</a>
                </li>
              </ul>
            </nav>
          </div>
          <!-- END col-9 -->
        </div>
        <!-- END row -->
      </div>
      <!-- END container -->
    </div>
    <!-- END section -->

    <div class="container">
      <!-- Collection Create -->
      <div>
        <form v-on:submit.prevent="collectionCreate()">
          <ul style="list-style-type: none">
            <li class="text-danger" v-for="error in errors" v-bind:key="error">
              {{ error }}
            </li>
          </ul>
          <strong>Create collection</strong><br />
          <small class="text-danger">This will be in a modal</small>
          <div class="form-group">
            <label>Name:</label>
            <input
              type="text"
              class="form-control"
              v-model="newCollectionParams.name"
            />
          </div>
          <div class="form-group">
            <label>Partners:</label>
            <input
              type="text"
              class="form-control"
              v-model="newCollectionParams.partners"
            />
          </div>
          <div class="form-group">
            <label>Highlights:</label>
            <input
              type="text"
              class="form-control"
              v-model="newCollectionParams.highlights"
            />
          </div>
          <input type="submit" class="btn btn-primary" value="Create" />
          <br />
        </form>
        <br />
      </div>

      <!-- Image Upload (after collection create) -->
      <div>
        <small class="text-danger">This will be in a second modal</small>
        <br />
        <form v-on:submit.prevent="imageCreate(collection)">
          <strong>Upload images</strong> <br />
          <input type="file" v-on:change="setFile($event)" ref="fileInput" />
          <br />
          <select v-model="collection">
            <option
              v-for="collection in collections"
              v-bind:key="collection.id"
              :value="collection"
            >
              {{ collection.name }}
            </option>
          </select>
          <br />
          <input type="submit" value="Upload Photo" />
        </form>
        <small class="text-danger">
          After creating a collection it will open another modal where the user
          <br />
          will upload images. This will use the collection id from the
          collection
          <br />
          create response data. Dropdown is temporary
        </small>
      </div>

      <!-- Collection Index -->
      <div>
        <h3>Collections:</h3>
        <div v-for="collection in collections" v-bind:key="collection.id">
          <p>
            <strong>Name: </strong>{{ collection.name }} <br />
            <strong>Partners: </strong>{{ collection.partners }} <br />
            <strong>Highlights: </strong>{{ collection.highlights }} <br />
            <router-link :to="`/collections/${collection.id}`">
              <button>More</button>
            </router-link>
          </p>
        </div>
      </div>
    </div>
  </div>
</template>

<style>
.text-danger {
  color: red;
}
.image {
  width: 350px;
  height: auto;
}
</style>

<script>
import axios from "axios";
import Vue2Filters from "vue2-filters";

export default {
  mixins: [Vue2Filters.mixin],
  data: function () {
    return {
      collections: [],
      newCollectionParams: {},
      errors: [],
      image: "",
      collection: {},
    };
  },
  created: function () {
    axios.get("/collections").then((response) => {
      console.log(response.data);
      this.collections = response.data;
    });
  },
  methods: {
    collectionCreate: function () {
      axios
        .post("/collections", this.newCollectionParams)
        .then((response) => {
          console.log(response.data);
          this.collections.push(response.data);
          this.newCollectionParams = {};
        })
        .catch((error) => {
          this.errors = error.response.data.errors;
        });
    },
    setFile: function (event) {
      if (event.target.files.length > 0) {
        this.image = event.target.files[0];
      }
    },
    imageCreate: function (collection) {
      var formData = new FormData();
      formData.append("image", this.image);
      formData.append("collection_id", collection.id);
      axios
        .post("/images", formData)
        .then((response) => {
          console.log(response.data);
          this.collection = {};
          this.image = "";
        })
        .catch((error) => {
          this.errors = error.response.data.errors;
        });
    },
  },
};
</script>
